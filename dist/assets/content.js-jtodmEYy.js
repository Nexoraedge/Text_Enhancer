(function(){function d(t,o){const e=t.toLowerCase(),n=o.toLowerCase();return e.includes("mail.google.com")||e.includes("outlook")||e.includes("yahoo.com/mail")||e.includes("mail")||n.includes("inbox")||n.includes("email")||n.includes("compose")?"email":e.includes("twitter.com")||e.includes("facebook.com")||e.includes("instagram.com")||e.includes("linkedin.com/feed")||e.includes("reddit.com")||n.includes("feed")||n.includes("post")||n.includes("timeline")?"social":e.includes("linkedin.com")&&!e.includes("linkedin.com/feed")||e.includes("docs.google.com")||e.includes("notion.so")||e.includes("slack.com")||e.includes("teams.microsoft.com")||n.includes("document")||n.includes("report")||n.includes("project")||n.includes("proposal")?"professional":e.includes("scholar.google.com")||e.includes(".edu")||e.includes("academia.edu")||e.includes("researchgate.net")||e.includes("coursera.org")||e.includes("canvas")||n.includes("course")||n.includes("assignment")||n.includes("paper")||n.includes("research")||n.includes("study")?"academic":e.includes("tinder.com")||e.includes("bumble.com")||e.includes("hinge.co")||e.includes("okcupid.com")||e.includes("match.com")||n.includes("dating")||n.includes("chat")&&(n.includes("match")||n.includes("date")||n.includes("love"))?"romantic":"general"}function i(t,o="info"){let e=document.getElementById("gemini-enhancer-toast-container");e||(e=document.createElement("div"),e.id="gemini-enhancer-toast-container",e.style.cssText=`
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 10000;
    `,document.body.appendChild(e));const n=document.createElement("div");n.style.cssText=`
    background-color: ${o==="error"?"#f44336":"#1a73e8"};
    color: white;
    padding: 12px 16px;
    border-radius: 4px;
    margin-top: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    font-size: 14px;
    max-width: 300px;
    opacity: 0;
    transition: opacity 0.3s;
  `,n.textContent=t,e.appendChild(n),setTimeout(()=>{n.style.opacity="1"},10),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{e.removeChild(n)},300)},3e3)}function u(){return document.activeElement}function r(t){if(!t)return!1;const o=t.tagName.toLowerCase(),e=t.getAttribute("contenteditable");return o==="input"&&["text","search","email","url","tel","number","password"].includes(t.type)||o==="textarea"||e==="true"}function m(){const t=document.activeElement;if(t&&(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable)){if(focusedElement=t,t.isContentEditable)return t.innerText||"";{const e=t.value||"";return e.trim()===""&&t.placeholder&&t.placeholder.trim()!==""?t.placeholder:e}}const o=document.querySelectorAll('input[type="search"], input[placeholder*="search"], input[placeholder*="Search"], textarea[placeholder*="prompt"], textarea[placeholder*="Prompt"]');if(o.length>0){focusedElement=o[0];const e=focusedElement.value||"";return e.trim()===""&&focusedElement.placeholder&&focusedElement.placeholder.trim()!==""?focusedElement.placeholder:e}return null}function p(t,o){if(!t||!r(t))return!1;const e=t.selectionStart,n=t.selectionEnd;if(t.tagName.toLowerCase()==="input"||t.tagName.toLowerCase()==="textarea"){if(t.value=o,typeof e=="number"&&typeof n=="number"){const c=Math.min(e,o.length);try{t.setSelectionRange(c,c)}catch(a){console.error("Failed to restore cursor position:",a)}}const l=new Event("input",{bubbles:!0});return t.dispatchEvent(l),!0}else if(t.getAttribute("contenteditable")==="true")return t.innerText=o,!0;return!1}function s(t,o=!0){navigator.clipboard.writeText(t).then(()=>{o&&i("Enhanced text copied to clipboard!","success")}).catch(e=>{console.error("Failed to copy text:",e),o&&i("Failed to copy to clipboard","error")})}async function h(){let t=u(),o;if(!r(t)){const c=document.querySelectorAll('input[type="search"], input[placeholder*="search"], input[placeholder*="Search"], textarea[placeholder*="prompt"], textarea[placeholder*="Prompt"]');c.length>0?t=c[0]:i("No input field found. Enhanced text will be copied to clipboard.","info")}if(r(t)){if(o=m(),!o||o.trim()==="")if(t.placeholder&&t.placeholder.trim()!=="")o=t.placeholder,i('Using placeholder text: "'+o.substring(0,20)+(o.length>20?"...":"")+'"');else{i("No text to enhance","error");return}}else{i("No text found to enhance","error");return}i("Enhancing text with Gemini AI...");const e=window.location.href,n=document.title,l=d(e,n);chrome.runtime.sendMessage({action:"enhance-text-with-gemini",text:o,context:l},c=>{c&&c.success?r(t)&&p(t,c.enhancedText)?(i("Text enhanced and filled in!","success"),s(c.enhancedText,!1)):s(c.enhancedText,!0):i(c&&c.error?`Error: ${c.error}`:"Failed to enhance text","error")})}chrome.runtime.onMessage.addListener((t,o,e)=>(t.action==="enhance-text"&&h(),!0));console.log("Gemini Text Enhancer content script loaded");
})()